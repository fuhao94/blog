---
title: 202110复习
date: 2021-10-25
categories:
 - 复习
---

### React 合成事件的优点

1. 更好的兼容性和跨平台
2. 挂载到根 DOM 容器，减少内存消耗，避免频繁解绑
3. 方便事件的统一管理（如事务机制）

### React 哪些不能命中 batchUpdate 机制

1. setTimeout setInterval等（和它调用的函数）
2. 自定义 DOM 事件（和它调用的函数）
3. React "管不到"的入口

### Fiber 如何优化性能

可能会遇到的性能问题：
1. JS 单线程，且和 DOM 渲染共用一个线程
2. 当组件足够复杂，组件更新时计算和渲染压力大
3. 同时再有 DOM 操作需求（动画，鼠标拖拽等）将卡顿

解决方案：
1. 将 `reconciliation` 阶段进行任务拆分（commit 不能拆分）
2. DOM 需要渲染时暂停，空闲时恢复
3. requestIdleCallback polyfill - `Scheduler`

### Key 的作用

* diff 算法中通过 tag 和 key 判断是否是 sameNode
* 减少渲染次数，提升渲染性能

### React-router 如何配置懒加载

`lazy` 配合 `suspense`

```js
import React, { lazy, suspense } from 'react';

const Home = lazy(() => import('./routes/Home'));
const About = lazy(() => import('./routes/About'));

const app = () => (
  <Router>
    <Suspense>
      <Switch>
        <Route path="/" exact component={Home} />
        <Route path="/about" component={About} />
      </Switch>
    </Suspense>
  </Router>
) 
```
